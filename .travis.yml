language: ruby

rvm:
  - jruby-9.1.6.0

env:
  - DB=postgres
  - SIDEKIQ_REDIS_HOST=localhost
  - DATABASE=demo_test
  - DB_USER=postgres
  - DB_PASSWORD=postgres
  - POSTGRES_HOST=localhost
  - DB_POOL=5


services:
  - postgresql

before_script:
  - bundle install
  - psql -c 'create database demo_test;' -U postgres

script:
  - RAILS_ENV=test bundle exec rake db:migrate --trace
  - bundle exec rake db:test:prepare
  - bundle exec rspec spec/

